<view class="container" wx:if="{{config.showLottery}}">
  <!-- é¡¶éƒ¨æ ‡é¢˜åŒºåŸŸ -->
  <view class="header-section">
    <view class="header-content">
      <text class="main-title">åŒè‰²çƒé€‰å·å·¥å…·</text>
      <text class="sub-title">çº¢çƒ33é€‰6 â€¢ è“çƒ16é€‰1 â€¢ æ™ºèƒ½åˆ†æ</text>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒºåŸŸ -->
  <scroll-view class="main-content" scroll-y="true">
    
    <!-- é€‰å·é¢æ¿ -->
    <view class="selection-card">
      <view class="card-header">
        <text class="card-title">é€‰å·é¢æ¿</text>
        <view class="selection-info">
          <text class="info-text">çº¢çƒï¼š{{redSelectedCount}}/6</text>
          <text class="info-text">è“çƒï¼š{{blueSelectedCount}}/1</text>
          <text class="info-text">ç»„åˆï¼š{{combinationCount}}æ³¨</text>
        </view>
      </view>

      <!-- çº¢çƒé€‰å· -->
      <view class="red-ball-section">
        <view class="section-header">
          <text class="section-title">çº¢çƒé€‰æ‹©ï¼ˆ33é€‰6ï¼‰</text>
          <view class="section-actions">
            <text class="action-btn" bindtap="selectAllRed">å…¨é€‰</text>
            <text class="action-btn" bindtap="clearRed">æ¸…ç©º</text>
            <text class="action-btn" bindtap="randomRed">éšæœº</text>
          </view>
        </view>
        <view class="red-ball-grid">
          <view class="ball-cell {{redSelected[index] ? 'selected' : ''}} {{isHotRedBall(index+1) ? 'hot' : ''}}" 
                wx:for="{{redBalls}}" wx:key="index"
                bindtap="selectRedBall" data-index="{{index}}">
            <text class="ball-number">{{item < 10 ? '0' + item : item}}</text>
            <text class="hot-badge" wx:if="{{isHotRedBall(index+1)}}">çƒ­</text>
            <text class="selection-order" wx:if="{{redSelected[index]}}">
              {{getRedSelectionOrder(index)}}
            </text>
          </view>
        </view>
        <view class="selected-preview" wx:if="{{redSelectedCount > 0}}">
          <text class="preview-label">å·²é€‰çº¢çƒå·ç ï¼š</text>
          <view class="selected-chips">
            <view class="chip" wx:for="{{redSelectedList}}" wx:key="index">
              <text class="chip-text">{{item < 10 ? '0' + item : item}}</text>
              <text class="chip-remove" bindtap="removeRedBall" data-ball="{{item}}">Ã—</text>
            </view>
          </view>
        </view>
      </view>

      <!-- è“çƒé€‰å· -->
      <view class="blue-ball-section">
        <view class="section-header">
          <text class="section-title">è“çƒé€‰æ‹©ï¼ˆ16é€‰1ï¼‰</text>
          <view class="section-actions">
            <text class="action-btn" bindtap="selectAllBlue">å…¨é€‰</text>
            <text class="action-btn" bindtap="clearBlue">æ¸…ç©º</text>
            <text class="action-btn" bindtap="randomBlue">éšæœº</text>
          </view>
        </view>
        <view class="blue-ball-grid">
          <view class="blue-ball-cell {{blueSelected[index] ? 'selected' : ''}} {{isHotBlueBall(index+1) ? 'hot' : ''}}" 
                wx:for="{{blueBalls}}" wx:key="index"
                bindtap="selectBlueBall" data-index="{{index}}">
            <text class="ball-number">{{item < 10 ? '0' + item : item}}</text>
            <text class="hot-badge" wx:if="{{isHotBlueBall(index+1)}}">çƒ­</text>
            <text class="selection-order" wx:if="{{blueSelected[index]}}">
              {{getBlueSelectionOrder(index)}}
            </text>
          </view>
        </view>
        <view class="selected-preview blue-selected-preview" wx:if="{{blueSelectedCount > 0}}">
          <text class="preview-label blue-preview-label">å·²é€‰è“çƒå·ç ï¼š</text>
          <view class="selected-chips">
            <view class="chip blue-chip" wx:for="{{blueSelectedList}}" wx:key="index">
              <text class="chip-text blue-chip-text">{{item < 10 ? '0' + item : item}}</text>
              <text class="chip-remove" bindtap="removeBlueBall" data-ball="{{item}}">Ã—</text>
            </view>
          </view>
        </view>
      </view>

      <!-- å¿«æ·æ“ä½œ -->
      <view class="quick-actions">
        <view class="quick-btn" bindtap="generateRandom">
          <text class="quick-icon">ğŸ²</text>
          <text class="quick-text">éšæœºä¸€æ³¨</text>
        </view>
        <view class="quick-btn" bindtap="generateSmart">
          <text class="quick-icon">ğŸ§ </text>
          <text class="quick-text">æ™ºèƒ½é€‰å·</text>
        </view>
        <view class="quick-btn" bindtap="generatePattern">
          <text class="quick-icon">ğŸ“Š</text>
          <text class="quick-text">è§„å¾‹é€‰å·</text>
        </view>
        <view class="quick-btn" bindtap="generateDouble">
          <text class="quick-icon">ğŸ”¢</text>
          <text class="quick-text">å¤å¼é€‰å·</text>
        </view>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="action-buttons">
        <button class="btn clear" bindtap="clearSelection">æ¸…ç©ºé€‰æ‹©</button>
        <button class="btn add" bindtap="addToResult">æ·»åŠ åˆ°ç»“æœ</button>
        <button class="btn batch" bindtap="generateBatch">æ‰¹é‡ç”Ÿæˆ</button>
      </view>
    </view>

    <!-- ç­›é€‰æ¡ä»¶ -->
    <view class="filter-card">
      <view class="card-header">
        <text class="card-title">ç­›é€‰æ¡ä»¶</text>
        <view class="filter-status">
          <text class="status-badge {{activeFilterCount > 0 ? 'active' : ''}}">
            {{activeFilterCount > 0 ? 'ç­›é€‰ä¸­(' + activeFilterCount + ')' : 'æœªç­›é€‰'}}
          </text>
        </view>
      </view>

      <!-- å·ç åˆ†å¸ƒæ¡ä»¶ -->
      <view class="filter-group">
        <text class="group-label">å·ç åˆ†å¸ƒ</text>
        <view class="distribution-filters">
          <!-- çº¢çƒå¥‡å¶æ¯” -->
          <view class="distribution-filter">
            <text class="distribution-label">çº¢çƒå¥‡å¶æ¯”</text>
            <view class="distribution-options">
              <view class="distribution-option {{filters.redOddEven === item.value ? 'selected' : ''}}"
                    wx:for="{{redOddEvenRatios}}" wx:key="value"
                    bindtap="setRedOddEven" data-ratio="{{item.value}}">
                <text class="option-text">{{item.name}}</text>
              </view>
            </view>
          </view>
          
          <!-- çº¢çƒå¤§å°æ¯” -->
          <view class="distribution-filter">
            <text class="distribution-label">çº¢çƒå¤§å°æ¯”</text>
            <view class="distribution-options">
              <view class="distribution-option {{filters.redSizeRatio === item.value ? 'selected' : ''}}"
                    wx:for="{{redSizeRatios}}" wx:key="value"
                    bindtap="setRedSizeRatio" data-ratio="{{item.value}}">
                <text class="option-text">{{item.name}}</text>
              </view>
            </view>
          </view>
          
          <!-- å’Œå€¼èŒƒå›´ -->
          <view class="distribution-filter">
            <text class="distribution-label">çº¢çƒå’Œå€¼èŒƒå›´</text>
            <view class="sum-range-controls">
              <input class="range-input" type="number" value="{{filters.redSumRange[0]}}" 
                     placeholder="21" bindinput="setRedSumRange" data-index="0"/>
              <text class="range-separator">-</text>
              <input class="range-input" type="number" value="{{filters.redSumRange[1]}}" 
                     placeholder="183" bindinput="setRedSumRange" data-index="1"/>
            </view>
          </view>
        </view>
      </view>

      <!-- è¿å·æ¡ä»¶ -->
      <view class="filter-group">
        <text class="group-label">è¿å·è®¾ç½®</text>
        <view class="consecutive-filters">
          <view class="consecutive-filter">
            <text class="consecutive-label">çº¢çƒè¿å·</text>
            <view class="consecutive-options">
              <view class="consecutive-option {{filters.redConsecutive === item.value ? 'selected' : ''}}"
                    wx:for="{{consecutiveOptions}}" wx:key="value"
                    bindtap="setRedConsecutive" data-value="{{item.value}}">
                <text class="option-text">{{item.name}}</text>
                <text class="option-desc">{{item.desc}}</text>
              </view>
            </view>
          </view>
          
          <view class="consecutive-filter">
            <text class="consecutive-label">ACå€¼èŒƒå›´</text>
            <view class="ac-value-options">
              <view class="ac-option {{filters.acValue === item ? 'selected' : ''}}"
                    wx:for="{{acValues}}" wx:key="index"
                    bindtap="setAcValue" data-value="{{item}}">
                <text class="option-text">{{item || 'ä¸é™'}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>

      <!-- åŒºé—´åˆ†å¸ƒ -->
      <view class="filter-group">
        <text class="group-label">åŒºé—´åˆ†å¸ƒ</text>
        <view class="zone-filters">
          <view class="zone-filter" wx:for="{{zoneOptions}}" wx:key="zone">
            <text class="zone-label">{{item.name}}åŒºï¼ˆ{{item.range}}ï¼‰</text>
            <view class="zone-controls">
              <text class="zone-btn" bindtap="decreaseZone" data-zone="{{item.zone}}">-</text>
              <text class="zone-value">{{getZoneCount(item.zone)}}</text>
              <text class="zone-btn" bindtap="increaseZone" data-zone="{{item.zone}}">+</text>
            </view>
          </view>
        </view>
      </view>

      <!-- ç­›é€‰æ ‡ç­¾ -->
      <view class="filter-tags" wx:if="{{activeFilterCount > 0}}">
        <view class="filter-tag" wx:for="{{activeFilterTags}}" wx:key="key">
          <text class="tag-text">{{item.text}}</text>
          <text class="tag-remove" bindtap="removeFilterTag" data-key="{{item.key}}">Ã—</text>
        </view>
        <text class="clear-all-tags" bindtap="clearAllFilterTags">æ¸…é™¤æ‰€æœ‰</text>
      </view>

      <!-- ç­›é€‰æ“ä½œ -->
      <view class="filter-actions">
        <view class="action-btn reset" bindtap="resetFilters">
          <text class="btn-icon">ğŸ”„</text>
          <text>é‡ç½®ç­›é€‰</text>
        </view>
        <view class="action-btn preview" bindtap="previewFilter">
          <text class="btn-icon">ğŸ‘ï¸</text>
          <text>é¢„è§ˆç»“æœ</text>
        </view>
        <view class="action-btn apply" bindtap="applyFilters">
          <text class="btn-icon">âœ…</text>
          <text>åº”ç”¨ç­›é€‰</text>
        </view>
      </view>
    </view>

    <!-- ç»“æœå±•ç¤º -->
    <view class="result-card">
      <view class="card-header">
        <text class="card-title">é€‰å·ç»“æœ</text>
        <view class="result-stats">
          <text class="stat-item">æ€»æ•°ï¼š{{filteredResults.length}}æ³¨</text>
          <text class="stat-item">ä¿ç•™ï¼š{{filterRate}}%</text>
          <text class="stat-item">é¡µæ•°ï¼š{{currentPage}}/{{totalPages}}</text>
        </view>
      </view>

      <view class="results-container">
        <!-- åŠ è½½çŠ¶æ€ -->
        <view class="loading-results" wx:if="{{isLoading}}">
          <view class="loading-spinner"></view>
          <text class="loading-text">åŠ è½½ä¸­...</text>
        </view>
        
        <!-- ç»“æœç½‘æ ¼ -->
        <view class="results-grid" wx:elif="{{filteredResults.length > 0}}">
          <view class="result-item {{item.isSpecial ? 'special-combination' : ''}}" 
                wx:for="{{currentPageResults}}" wx:key="index" 
                wx:for-index="resultIndex">
            
            <!-- åŒè‰²çƒå·ç æ˜¾ç¤º -->
            <view class="ssq-number">
              <!-- çº¢çƒå·ç  -->
              <view class="red-number-group">
                <text class="result-number red-number {{isHotRedBall(number) ? 'highlight-number' : ''}}" 
                      wx:for="{{item.redNumbers}}" wx:key="index" wx:for-item="number">
                  {{number < 10 ? '0' + number : number}}
                </text>
              </view>
              
              <!-- åˆ†éš”ç¬¦ -->
              <text class="plus-sign">+</text>
              
              <!-- è“çƒå·ç  -->
              <view class="blue-number-group">
                <text class="result-number blue-number {{isHotBlueBall(item.blueNumber) ? 'highlight-number' : ''}}">
                  {{item.blueNumber < 10 ? '0' + item.blueNumber : item.blueNumber}}
                </text>
              </view>
            </view>
            
            <!-- åˆ†æä¿¡æ¯ -->
            <view class="result-info">
              <text class="info-item sum">
                <text class="info-label">å’Œå€¼</text>
                <text class="info-value">{{item.sum}}</text>
              </text>
              
              <text class="info-item odd-even">
                <text class="info-label">å¥‡å¶æ¯”</text>
                <text class="info-value">{{item.oddEvenRatio}}</text>
              </text>
              
              <text class="info-item size">
                <text class="info-label">å¤§å°æ¯”</text>
                <text class="info-value">{{item.sizeRatio}}</text>
              </text>
              
              <text class="info-item ac">
                <text class="info-label">ACå€¼</text>
                <text class="info-value">{{item.acValue}}</text>
              </text>
              
              <text class="info-item consecutive" wx:if="{{item.consecutiveCount > 0}}">
                <text class="info-label">è¿å·ç»„æ•°</text>
                <text class="info-value">{{item.consecutiveCount}}ç»„</text>
              </text>
            </view>
            
            <!-- ç»“æœåºå· -->
            <view class="result-index">
              <text class="index-badge">#{{resultIndex + 1 + (currentPage - 1) * pageSize}}</text>
            </view>
          </view>
        </view>
        
        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state" wx:else>
          <text class="empty-icon">ğŸ¯</text>
          <text class="empty-text">æš‚æ— é€‰å·ç»“æœ</text>
          <text class="empty-tip">è¯·é€‰æ‹©å·ç å¹¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨ï¼Œæˆ–è°ƒæ•´ç­›é€‰æ¡ä»¶</text>
        </view>
      </view>

      <!-- åˆ†é¡µæ§åˆ¶ -->
      <view class="pagination" wx:if="{{totalPages > 1}}">
        <view class="page-info">
          <text class="page-info-text">ç¬¬ {{currentPage}}/{{totalPages}} é¡µ</text>
          <text class="page-info-text">æ¯é¡µ {{pageSize}} æ³¨ï¼Œå…± {{filteredResults.length}} æ³¨</text>
        </view>
        <view class="page-controls">
          <button class="page-btn" bindtap="prevPage" disabled="{{currentPage === 1}}">
            â† ä¸Šä¸€é¡µ
          </button>
          <button class="page-btn" bindtap="nextPage" disabled="{{currentPage === totalPages}}">
            ä¸‹ä¸€é¡µ â†’
          </button>
        </view>
      </view>

      <!-- ç»“æœæ“ä½œ -->
      <view class="result-actions" wx:if="{{filteredResults.length > 0}}">
        <view class="result-btn" bindtap="clearResults">
          <text class="btn-icon">ğŸ—‘ï¸</text>
          <text class="result-btn-text">æ¸…ç©ºç»“æœ</text>
        </view>
        <view class="result-btn" bindtap="exportResults">
          <text class="btn-icon">ğŸ“¤</text>
          <text class="result-btn-text">å¯¼å‡ºç»“æœ</text>
        </view>
        <view class="result-btn" bindtap="saveResults">
          <text class="btn-icon">ğŸ’¾</text>
          <text class="result-btn-text">ä¿å­˜æ–¹æ¡ˆ</text>
        </view>
      </view>
    </view>
  </scroll-view>
</view>